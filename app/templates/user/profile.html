{% extends "base.html" %}

{% block title %}{{ '%s\'s profile' %user.username }}{% endblock %}

{% block content %}

    {{ super() }}

    <div class="row">
        <div class="col-xs-12 col-md-12"><div href="#" class="thumbnail profile clearfix">

            <div class="avatar"><img src="{{ user.avatar(256) }}" alt="avatar"></div>

            <div class="text">
                <h3>{{ user.name }}</h3>
                {% if user.description %} <p>{{ user.description }}</p> {% endif %}

                {% if user.location %}
                    <p>
                        <span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span>
                        <a href="http://maps.google.com/?q={{ user.location }}">{{ user.location }}</a>
                    </p>
                {% endif %}

                {% if current_user.is_administrator %}
                    <p><a href="mailto:{{ user.email }}">{{ user.email }}</a></p>
                {% endif %}

                <p>关注 <strong>{{ user.followers.count() }}</strong> 人，粉丝 <strong>{{ user.followed.count() }}</strong> 人</p>

                {#            <p>在 <span id="member_since"></span> 加入浪</p>#}
                <p>{{ _('于 %s 时加入浪' %moment(user.member_since).format('L')) }}</p>
                {#            <p>最近一次出没 <span id="last_seen"></span></p>#}
                <p>{{ _('最近一次出现在%s' %moment(user.last_seen).fromNow()) }}</p>

                {% if current_user == user %}
                    <p>
                        <a href="{{ url_for('.edit_profile') }}" class="btn btn-primary" role="button">{{ _('Edit Profile') }}</a>
                        {#                            <a href="#" class="btn btn-default" role="button">Button</a>#}
                    </p>
                {% elif not current_user.is_following(user) %}
                    <p><a href="#" class="btn btn-primary" role="button">关注TA</a></p>
                {% else %}
                    <p><a href="#" class="btn btn-default" role="button" disabled=true>已关注</a></p>
                {% endif %}
            </div>


        </div></div>
    </div>

    {% if user.tags and current_user == user %}
    <div class="row">
        <div class="col-xs-12 col-md-12">
            <div class="thumbnail">
                <h3>
                    {{ _('My tags') }}
                    {% if current_user == user %}
                        <button class="close" type="button">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </button>
                    {% endif %}
                </h3>
                <p>
                    {% for tag in user.tags %}
                        <a href="#">
                            <span class="glyphicon glyphicon-tags" aria-hidden="true"></span>&nbsp{{ tag.name }}
                        </a>
                    {% endfor %}
                </p>

            </div>
        </div>
    </div>
    {% endif %}

    {% if user.posts %}
        {% for post in user.posts %}
            {% include 'user/_post_thumbnail.html' %}
        {% endfor %}
    {% endif %}

{% endblock %}

{% block scripts %}
{{ super() }}

{#<script>#}
{#    $(document).ready(function () {#}
{#        var since = "{{ user.member_since.strftime('%Y-%m-%dT%H:%M:%S' + 'Z') }}";#}
{#        var last = "{{ user.last_seen.strftime('%Y-%m-%dT%H:%M:%S' + 'Z') }}";#}
{#        $('span#member_since').text(moment(since).format('L'))#}
{#        $('span#last_seen').text(moment(last).fromNow())#}
{#    })#}
{#</script>#}
{% endblock %}